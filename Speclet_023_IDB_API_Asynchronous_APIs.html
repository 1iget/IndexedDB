<!DOCTYPE html>
<html lang='en-US'>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
    <title>Indexed Database API</title>
    <meta name='revision' content='$Id: Overview.html,v 1.41 2010/03/24 17:58:17 nmehta3 Exp $'/>
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/respec.js' class='remove'></script>
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/simple-node.js' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          specStatus:           "ED",

          shortName:            "IndexedDB",

          //publishDate:          "2010-01-05",

          previousPublishDate:  "2010-01-05",
          previousMaturity:     "WD",

          edDraftURI:           "http://dev.w3.org/2006/webapi/WebSimpleDB/",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",

          extraCSS: [
                "http://dev.w3.org/2009/dap/ReSpec.js/css/respec.css",
                "SimpleDB.css"
          ],

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Nikunj Mehta", url: "mailto:nikunj@o-micron.com",
                company: "Invited Expert" },
          ],

          maxTocLevel: 3,

          wg:           "Web Applications Working Group",

          wgURI:        "http://www.w3.org/2008/webapps/",

          wgPublicList: "public-webapps",

          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/42538/status",
      };
    </script>
    <script class="remove">
      function examples() {
        var examples = document.querySelectorAll('div.example');
        sn = new berjon.simpleNode({
                        "":     "http://www.w3.org/1999/xhtml",
                        "x":    "http://www.w3.org/1999/xhtml"
                    });
        for (var i = 0; i < examples.length; i++) {
          var example = examples.item(i);
          var header = sn.element('div', {'class': 'exampleHeader'}, null, 'Example');
          example.insertBefore(header, example.firstChild);
        }
      }

      function codeblocks() {
        document.normalize();
        sn = new berjon.simpleNode({
                        "":     "http://www.w3.org/1999/xhtml",
                        "x":    "http://www.w3.org/1999/xhtml"
                    });

        var blocks = document.querySelectorAll('codeblock');
        for (var i = 0; i < blocks.length; i++) {
          var codeblock = blocks.item(i);
          var div = sn.element('div', {'class': 'block'})
          sn.element('span', {'class': 'blockTitle'},
            sn.element('div', {'class': 'blockTitleDiv'}, div), 'ECMAScript');
          var code = sn.element('code', {'class': 'es-code'},
                       sn.element('pre', {'class': 'code'},
                         sn.element('div', {'class': 'blockContent'}, div)));
          sn.copyChildren(codeblock, code);
          codeblock.parentNode.replaceChild(div, codeblock);
        }
      }
      window.onload = function() {
        examples();
        codeblocks();
        (new berjon.respec()).loadAndRun();
      }
    </script>
    <!--[if IE]>
    <style type='text/css'>
      .ignore {
        -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
        filter: alpha(opacity=50);
      }
    </style>
    <![endif]-->
    <style type="text/css">
      table {
        border-collapse: collapse;
        border-style: hidden hidden none;
      }
      table thead {
        border-bottom: medium solid;
      }
      table td, table th {
        border-bottom: thin solid;
        border-left: medium solid;
        border-right: medium solid;
        padding: 0.2em;
        vertical-align: top;
      }
      h5 {
        display: none
      }
    </style>
  </head>

  <body>
    <section id="abstract">
      <p>
        This document defines APIs for a database of records holding simple values
        and hierarchical objects. Each record consists of a key and some value.
        Moreover, the database maintains indexes over records it stores. An
        application developer directly uses an API to locate records either by
        their key or by using an index. A query language can be layered on this
        API. An indexed database can be implemented using a persistent B-tree data
        structure.
      </p>
    </section>

    <section id="database-api" class="section">
      <h2>Indexed Database API</h2>

      <!-- begin-content -->
      <section class="section" id="async-api"> 
        <h3>Asynchronous APIs</h3>
        <p>
          The asynchronous API returns without blocking the calling thread.
          This API can only be used in a <a class="externalDFN"><code>Window</code></a>. 
          Asynchronous APIs are essentially the same as the synchronous ones 
          except that the result of an operation is not available when the 
          operation returns.
        </p>
        <section class="section informative" id="events">
          <h4>Event summary</h4>
          <p>
            Events are fired during asynchronous access as <a>database</a> 
            <a>objects</a> are created and data is consumed from these objects. 
            As requests are made to <a>database</a> <a>objects</a>, the user 
            agent loads information about them into memory and when the required
            object handle is available, it alerts the application through the
            firing of events. The events are as follows:
          </p>
          <table>
            <thead><tr><th>Event name</th><th>Dispatched when...</th></tr></thead>
            <tbody>
              <tr>
                <td><dfn title="event-success"><code>success</code></dfn></td>
                <td>The database request has been completed and its results are 
                available.</td>
              </tr>
              <tr>
                <td><dfn title="event-error"><code>error</code></dfn></td>
                <td>There was an error performing the database request.</td>
              </tr>
            </tbody>
          </table>
        </section>
        
        <section class="section" id="request-api">
          <h4>The <code>IDBRequest</code> Interface</h4>
          <p>
            The <a><code>IDBRequest</code></a> interface provides means to access results of  
            asynchronous requests to <a title="database">databases</a> and <a>database</a> 
            <a>objects</a> using <a>event handler attributes</a> [[!DOM-LEVEL-3-EVENTS]]. 
          </p>
          <div class="example">       
            <p>
              In the following example, we open a <a>database</a> asynchronously. Various 
              event handlers are registered for responding to various situations.
            </p>
            <codeblock>indexedDB.request.<a>onsuccess</a> = function(evt) {...};
indexedDB.request.<a>onerror</a> = function(evt) {...};
indexedDB.<a>open</a>('AddressBook', 'Address Book');</codeblock>
          </div>
          <dl class="idl" title="interface IDBRequest"> 
            <dt>void abort()</dt>
            <dd>This method has no effect if the 
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            is not <a class="idlType" href="#widl-IDBRequest-LOADING"><code>LOADING</code></a>.
            Otherwise, the implementation makes a best effort attempt to discontinue
            the in-flight request. The <a title="event-success">success event</a>
            is fired if the implementation cannot abort this request and completes
            the request successfully, otherwise the <a title="event-error">error event</a>
            is fired. The
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            moves to <a class="idlType" href="#widl-IDBRequest-DONE"><code>DONE</code></a>.
            If the request aborts successfully, the
            <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> is set
            to <a class="idlType" href="#widl-IDBDatabaseException-UNKNOWN_ERR"><code>UNKNOWN_ERR</code></a>.</dd>
            <dt>const     unsigned short INITIAL = 0</dt>
            <dd>This state indicates that a request has not been started.</dd>
            <dt>const     unsigned short LOADING = 1</dt>
            <dd>This state indicates that a request has been started but its results is not
            yet available.</dd>
            <dt>const     unsigned short DONE = 2</dt>
            <dd>This state indicates that a result to a previous request is available in
            the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> attribute.</dd>
            <dt>readonly attribute unsigned short readyState</dt>
            <dd>The state of this object</dd>
            <dt>readonly attribute IDBDatabaseError error</dt>
            <dd>The error that occurred during the requested operation. In the 
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            <a class="idlType" href="#widl-IDBRequest-INITIAL"><code>INITIAL</code></a> and 
            <a class="idlType" href="#widl-IDBRequest-LOADING"><code>LOADING</code></a>,
            getting this attribute returns <code>null</code>.</dd>
            <dt>readonly attribute any result</dt>
            <dd>The result of a successful requested operation</dd>
  
            <dt>attribute Function onsuccess</dt>
            <dd>The event handler for the <a title="event-success">success event</a></dd>
            <dt>attribute Function onerror</dt>
            <dd>The event handler for the <a title="event-error">error event</a></dd>
          </dl>
          <div class="idl" title="IDBRequest implements EventTarget"></div>
          <p>
            When a request is made, the 
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a> changes to 
            <a class="idlType" href="#widl-IDBRequest-LOADING"><code>LOADING</code></a>. 
            Once the result of the request is available, the
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            changes to <a class="idlType" href="#widl-IDBRequest-DONE"><code>DONE</code></a>, 
            place the result of the request in 
            <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a>,
            and <a>queue a task</a> to fire an event with the name <code>success</code>, 
            with no namespace, which does not bubble, is not cancelable, and which uses  
            the <a class="externalDFN"><code>Event</code></a> interface at each 
            <a class="externalDFN"><code>Window</code></a> object.
          </p>
          <p>
            If an exception occurs while performing the operation, the 
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            changes to <a class="idlType" href="#widl-IDBRequest-DONE"><code>DONE</code></a>, 
            the error information is placed in a new <a><code>IDBDatabaseError</code></a>
            object at the
            <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> 
            attribute, and <a>queue a task</a> to fire an event with the name 
            <code>error</code>, with no namespace, which does not bubble, is 
            not cancelable, and which uses the <a class="externalDFN"><code>Event</code></a> 
            interface at each <a class="externalDFN"><code>Window</code></a> object.
          </p>
           
          <p>
            The <span>task source</span> for these tasks is the 
            <dfn id="database-access-task-source">database access task source</dfn>.
          </p>    
        </section>
        
        <section class="section" id="requests">
          <h4>Asynchronous Request API</h4>
         <p>
            <a title="Window"><a class="externalDFN"><code>Window</code></a> objects MUST implement the 
            <a><code>IDBEnvironment</code></a> interface.
          </p>
          <p class="idl" title="Window implements IDBEnvironment">
          </p>
          
          <dl class="idl" title="interface IDBEnvironment">
            <dt>readonly attribute IDBFactoryRequest indexedDB</dt>
            <dd>This attribute provides applications a mechanism for accessing
              capabilities of indexed databases.</dd>
          </dl>
          <p>
            Every interface for making asynchronous requests includes a 
            <a><code>IDBRequest</code></a> object that communicates back to the requesting
            application through events.
            This design means that only a single request can be active on any <a>database</a>
            or <a title="objects">object</a> handle at a time. If a second request is
            started, the user agent MUST abort any previous active request.
          </p>
          <dl class="idl" title="interface IDBFactoryRequest">
            <dt>readonly attribute IDBRequest request</dt>
            <dd>The request associated with this object, which will be used to
            relay the results of processing back to the caller</dd>
            <dt>void open()</dt>
            <dd>
              <p>
                This method returns immediately and runs the
                following steps in a different thread.
                If an error occurs while the <a>database</a> <a>connection</a> 
                is being opened, then this object's request 
                <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> is populated 
                with a new <a><code>IDBDatabaseError</code></a> object whose code is set
                to <a class="idlType" href="#widl-IDBDatabaseException-UNKNOWN_ERR"><code>UNKNOWN_ERR</code></a>.
              </p>
    
              <ol>
                <li>
                  Let <var>origin</var> be the origin of the active document from which
                  the method was invoked.                
                </li>
                <li>
                  Perform the <a>steps for opening a database</a>, with <var>origin</var>,
                  the <var>name</var> parameter and <var>description</var> parameter, and 
                  call its result as <var>result</var>.
                </li>
                <li>
                  If the steps were aborted with an error code, then set this request's
                  <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> with that code 
                  and abort these steps.
                </li>
                <li>
                  Create a <a><code>IDBDatabaseRequest</code></a> object for <var>result</var>
                  and call it <var>db</var>.
                </li>
                <li>
                  Set the <a>result</a> of this object's request to <var>db</var>.
              </ol>              
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="database name">name</a> for the <a>database</a></dd>
                <dt>DOMString description</dt>
                <dd>The description for the <a>database</a></dd>
                <dt>optional boolean modifyDatabase</dt>
                <dd>This defaults to true</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NON_TRANSIENT_ERR</dt>
                <dd>if the <var>name</var> parameter is not <a>valid</a></dd>
              </dl>
            </dd>
          </dl>
          <dl class="idl" title="interface IDBDatabaseRequest : IDBDatabase">
            <dt>readonly attribute IDBRequest request</dt>
            <dd>The request associated with this object, which will be used to
            relay the results of processing back to the caller</dd>
            <dt>void createObjectStore()</dt>
            <dd>
              <p>
                This method returns immediately and creates a new <a>object store</a>
                with the given name in the <a title="connection">connected</a> 
                <a>database</a>. If an <a>object store</a> with the same name, compared
                in a case-sensitive manner, already exists in the 
                <a title="connection">connected</a> <a>database</a>, then this object's
                request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new <a><code>IDBDatabaseError</code></a>
                object whose code is set to <a class="idlType" href="#widl-IDBDatabaseException-CONSTRAINT_ERR"><code>CONSTRAINT_ERR</code></a>. If the
                <a>object store</a> is created, the 
                <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this 
                object's request is set to a new <a><code>IDBObjectStoreRequest</code></a> 
                for that <a>object store</a>.
              </p>
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="object store name">name</a> of a new <a>object store</a></dd>
                <dt>[TreatNullAs=EmptyString] DOMString keyPath</dt>
                <dd>The <a title="object store key path">key path</a> of a new 
                <a>object store</a>. If <a>null</a> path is specified, then the 
                <a>object store</a> created will not have a <a>key path</a> and will
                use <a>out-of-line keys</a>.</dd>
                <dt>optional boolean autoIncrement</dt>
                <dd>Whether the <a>object store</a> created should have a 
                <a>key generator</a>.</dd>
              </dl>
            </dd>
            <dt>void openObjectStore()</dt>
            <dd>
              <p>
                This method returns immediately and opens the <a>object store</a> with 
                the given name in the <a title="connection">connected</a> <a>database</a>
                for the <a>mode</a> specified. If an <a>object store</a> with the given
                name does not exist in the <a title="connection">connected</a> <a>database</a>, 
                then this object's request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new 
                <a><code>IDBDatabaseError</code></a> object whose code is set to 
                <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>. If the <a>object store</a> is opened,
                the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this
                object's request is set to a new 
                <a><code>IDBObjectStoreRequest</code></a> for that <a>object store</a>.
              </p>              
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="object store name">name</a> of an existing 
                <a>object store</a></dd>
                <dt>optional unsigned short mode</dt>
                <dd>The <a>mode</a> used to access the <a>object store</a></dd>
              </dl>
            </dd>
            <dt>void createIndex()</dt>
            <dd>
              <p>
                This method returns immediately and creates a new <a>index</a>
                with the given name and parameters in the 
                <a title="connection">connected</a> <a>database</a>. If an <a>index</a> 
                with the same name, compared in a case-sensitive manner, already exists
                in the <a title="connection">connected</a> <a>database</a>, then this 
                object's request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new 
                <a><code>IDBDatabaseError</code></a> object whose code is set to 
                <a class="idlType" href="#widl-IDBDatabaseException-CONSTRAINT_ERR"><code>CONSTRAINT_ERR</code></a>. If the <a>object store</a> with the
                given name does not exist in the <a title="connection">connected</a> 
                <a>database</a> then this object's request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new 
                <a><code>IDBDatabaseError</code></a> object whose code is set to 
                <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>. If the <a>index</a> is created, the
                <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this object's
                request is set to a new 
                <a><code>IDBIndexRequest</code></a> for that <a>index</a>.
              </p>
              <dl class="parameters">
                <dt>DOMString      name</dt>
                <dd>The <a title="index name">name</a> of a new <a>index</a></dd>
                <dt>DOMString      storeName</dt>
                <dd>The <a title="object store name">name</a> of an existing
                <a>object store</a> <a>referenced</a> by the new <a>index</a></dd>
                <dt>DOMString      keyPath</dt>
                <dd>The <a title="index key path">key path used by the new
                <a>index</a></dd>
                <dt>optional boolean unique</dt>
                <dd>The <a>unique</a> flag for the new <a>index</a></dd>
              </dl>
            </dd>
            <dt>void openIndex()</dt>
            <dd>
              <p>
                This method returns immediately and opens the <a>index</a> with the
                given name in the <a title="connection">connected</a> <a>database</a>.
                If an <a>index</a> with the given
                name does not exist in the <a title="connection">connected</a> <a>database</a>, 
                then this object's request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new 
                <a><code>IDBDatabaseError</code></a> object whose code is set to 
                <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>. If the <a>index</a> is opened,
                the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a>
                of this object's request is set to a new 
                <a><code>IDBIndexRequest</code></a> for that <a>index</a>.
              </p>              
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="index name">name</a> of an existing <a>index</a></dd>
              </dl>      
            </dd>
            <dt>void removeObjectStore()</dt>
            <dd>
              <p>
                This method returns immediately and destroys the <a>object store</a>
                with the given name in the <a title="connection">connected</a> 
                <a>database</a> as well as all <a title="index">indexes</a> that are 
                <a title="referenced">referencing</a> that <a>object store</a>. If an 
                <a>object store</a> with the given name does not exist in the 
                <a title="connection">connected</a> <a>database</a>, 
                then this object's request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new 
                <a><code>IDBDatabaseError</code></a> object whose code is set to 
                <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>. 
              </p>
              
              <dl class="parameters">
                <dt>DOMString storeName</dt>
                <dd>The <a title="object store name">name</a> of an existing
                <a>object store</a></dd>
              </dl>
            </dd>
            <dt>void removeIndex()</dt>
            <dd>
              <p>
                This method returns immediately and destroys the <a>index</a>
                with the given name in the <a title="connection">connected</a> 
                <a>database</a>. If an <a>index</a> with the given name does not 
                exist in the <a title="connection">connected</a> <a>database</a>, 
                then this object's request <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
                is populated with a new 
                <a><code>IDBDatabaseError</code></a> object whose code is set to 
                <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>. 
              </p>
              <dl class="parameters">
                <dt>DOMString indexName</dt>
                <dd>The <a title="index name">name</a> of an existing <a>index</a></dd>
              </dl>
            </dd>
            <dt>void setVersion()</dt>
            <dd>
              This method returns immediately and sets the <a>version</a> of the 
              <a title="connection">connected</a> <a>database</a>.
              <dl class="parameters">
                <dt>[TreatNullAs=EmptyString] DOMString      version</dt>
                <dd>The <a>version</a> to store in the <a>database</a></dd>
              </dl>
            </dd>
            <dt>void openTransaction()</dt>
            <dd>
              This method returns immediately and performs the 
              <a>steps for creating a transaction</a> with the list of <a>database</a> 
              <a>objects</a> for acquiring locks required in this <a>transaction</a> 
              and an optional timeout duration. If a <a>transaction</a> can be created
              successfully, then the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a>
              of this object's request is set to a new 
              <a><code>IDBTransactionRequest</code></a> object. If reserving all the 
              <a>database</a> <a>objects</a> identified in the requested <a>scope</a> 
              takes longer than the specified timeout interval, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> of
              this object's request is set to the code 
              <a class="idlType" href="#widl-IDBDatabaseException-TIMEOUT_ERR"><code>TIMEOUT_ERR</code></a>.
              <dl class="parameters">
                <dt>optional DOMStringList storeNames</dt>
                <dd>The names of <a title="object store">object stores</a> and 
                <a title="index">indexes</a> in the <a>scope</a> of the new
                <a>transaction</a></dd>
                <dt>optional unsigned long timeout</dt>
                <dd>The interval which this operation is allowed to take to
                reserve all the <a>database</a> objects identified in the new
                <a title="transaction">transaction's</a> <a>scope</a>. The default
                is user agent specific</dd>
              </dl>
            </dd>
          </dl>
          <dl class="idl" title="interface IDBObjectStoreRequest : IDBObjectStore">
            <dt>readonly attribute IDBRequest request</dt>
            <dd>The request associated with this object, which will be used to
            relay the results of processing back to the caller</dd>
            <dt>void put()</dt>
            <dd>
              This method returns immediately and stores the given value in this 
              <a>object store</a> by following the 
              <a>steps for storing a record into an object store</a>. If the record
              can be successfully stored in the <a>object store</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a>
              of this object's request is set to the key for the stored record.
              If the <var>noOverwrite</var> parameter was true and a record exists
              in this <a>object store</a> for the key <var>key</var> parameter, then
              the <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code 
              <a class="idlType" href="#widl-IDBDatabaseException-CONSTRAINT_ERR"><code>CONSTRAINT_ERR</code></a>. If this <a>object store</a> uses 
              <a>out-of-line</a> keys but does not use a <a>key generator</a> and the
              <var>key</var> parameter was not passed, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this object's
              request is set to code <a class="idlType" href="#widl-IDBDatabaseException-DATA_ERR"><code>DATA_ERR</code></a>. If the data being 
              stored could not be serialized by the <a>internal structured cloning algorithm</a>,
              then the <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code 
              <a class="idlType" href="#widl-IDBDatabaseException-SERIAL_ERR"><code>SERIAL_ERR</code></a>.
              <dl class="parameters">
                <dt>any value</dt>
                <dd>The value to be stored in the record</dd>
                <dt>optional any key</dt>
                <dd>The key used to identify the record</dd>
                <dt>optional boolean noOverwrite</dt>
                <dd>Whether to overwrite an existing record with the same key</dd>
              </dl>
            </dd>
            <dt>void remove()</dt>
            <dd>
              This method returns immediately and removes the record from this 
              <a>object store</a> by following the 
              <a>steps for deleting a record from an object store</a> corresponding to
              the given key. If a record did not exist in this <a>object store</a> 
              for the key <var>key</var> parameter, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this object's
              request is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be removed</dd>
              </dl>
            </dd>
            <dt>void get()</dt>
            <dd>
              This method returns immediately and retrieves the value from this 
              <a>object store</a> for the record corresponding to the given key by
              following the <a>steps for retrieving a record from an object store</a>. 
              If the operation is successful, then the 
              <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this object's request
              is set to the retrieved value. If a record did not exist in this 
              <a>object store</a> for the key <var>key</var> parameter, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be retrieved</dd>
              </dl>
            </dd>
            <dt>void openCursor()</dt>
            <dd>
              This method returns immediately and creates a <a>cursor</a> over the 
              <a>records</a> of this <a>object store</a>. The <a>range</a> of this
              <a>cursor</a> matches the <a>key range</a> specified as the
              <var>range</var> parameter, or if that parameter is not specified or
              <code>null</code>, then the range includes all the <a>records</a>. 
              If there is even a single record that matches the <a>key range</a>, then  
              the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a>
              of this object's request is set to the 
              <a><code>IDBCursorRequest</code></a> object for that <a>cursor</a>. If no
              records match the <a>key range</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> of this object's request
              is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>optional IDBKeyRange    range</dt>
                <dd>The <a>key range</a> to use as the <a>cursor</a>'s <a>range</a></dd>
                <dt>optional unsigned short direction</dt>
                <dd>The <a>cursor<a>'s required <a>direction</a></dd>
              </dl>
            </dd>
          </dl>
          <dl class="idl" title="interface IDBIndexRequest : IDBIndex">
            <dt>readonly attribute IDBRequest request</dt>
            <dd>The request associated with this object, which will be used to
            relay the results of processing back to the caller</dd>
            <dt>void openObjectCursor()</dt>
            <dd>
              This method returns immediately and creates a <a>cursor</a> over the 
              <a>records</a> of this <a>index</a>'s <a>referenced</a> <a>object store</a> 
              as arranged by this <a>index</a>. The <a>range</a> of this <a>cursor</a> 
              matches the <a>key range</a> specified as the <var>range</var> parameter, or
              if that parameter is not specified or <code>null</code>, then the 
              range includes all the <a>records</a>.
              If there is even a single record that matches the <a>key range</a>, then  
              the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a>
              of this object's request is set to the 
              <a><code>IDBCursorRequest</code></a> object for that <a>cursor</a>. If no
              records match the <a>key range</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> of this object's request
              is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>optional IDBKeyRange    range</dt>
                <dd>The <a>key range</a> to use as the <a>cursor</a>'s <a>range</a></dd>
                <dt>optional unsigned short direction</dt>
                <dd>The <a>cursor<a>'s required <a>direction</a></dd>
              </dl>
            </dd>
            <dt>void openCursor()</dt>
            <dd>
              This method returns immediately and creates a <a>cursor</a> over the 
              <a>records</a> of this <a>index</a>. The <a>range</a> of this <a>cursor</a>
              matches the <a>key range</a> specified as the <var>range</var> parameter, or
              if that parameter is not specified or <code>null</code>, then the 
              range includes all the <a>records</a>. 
              If there is even a single record that matches the <a>key range</a>, then  
              the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this 
              object's request is set to the 
              <a><code>IDBCursorRequest</code></a> object for that <a>cursor</a>. If no
              records match the <a>key range</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> of this object's request
              is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>optional IDBKeyRange    range</dt>
                <dd>The <a>key range</a> to use as the <a>cursor</a>'s <a>range</a></dd>
                <dt>optional unsigned short direction</dt>
                <dd>The <a>cursor<a>'s required <a>direction</a></dd>
              </dl>
            </dd>
            <dt>void put()</dt>
            <dd>
              This method returns immediately and stores the given value in this <a>index</a>
              by following the <a>steps for storing a record into an index</a>. If the
              operation succeeds, then the 
              <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> 
              of this object's request is set to
              the key for the stored record. If the <var>noOverwrite</var> parameter was 
              <code>true</code> and a record exists in this <a>index</a> for the key 
              <var>key</var> parameter or this <a>index</a> is <a>auto-populated</a> or if no
              record exists with key <var>value</var> parameter in the <a>index</a>'s
              <a>referenced</a> <a>object store</a>, then the <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> 
              of this object's request
              is set to code <a class="idlType" href="#widl-IDBDatabaseException-CONSTRAINT_ERR"><code>CONSTRAINT_ERR</code></a>.
              <dl class="parameters">
                <dt>any value</dt>
                <dd>The value to be stored in the record</dd>
                <dt>optional any key</dt>
                <dd>The key used to identify the record</dd>
                <dt>optional boolean noOverwrite</dt>
                <dd>Whether to overwrite an existing record with the same key. This defaults
                to <code>false</code>.</dd>
              </dl>
            </dd>
            <dt>void getObject()</dt>
            <dd>
              This method returns immediately and retrieves the value from this <a>index</a>'s
              <a>referenced</a> <a>object store</a> for the record corresponding to the given
              key by following the <a>steps for retrieving a record from an index</a>.
              If the operation is successful, then the 
              <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this object's request
              is set to the retrieved value. If a record did not exist in this 
              <a>index</a> for the key <var>key</var> parameter, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be retrieved</dd>
              </dl>
-            </dd>
            <dt>void get()</dt>
            <dd>
              This method returns immediately and retrieves the value from this <a>index</a>
              for the record corresponding to the given <var>key</var> parameter by 
              following the <a>steps for retrieving a value from an index</a>.
              If the operation is successful, then the 
              <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> of this object's request
              is set to the retrieved value. If a record did not exist in this 
              <a>index</a> for the key <var>key</var> parameter, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be retrieved</dd>
              </dl>
            </dd>
            <dt>void remove()</dt>
            <dd>
              This method returns immediately and removes the records from this <a>index</a>
              by following the <a>steps for deleting a record from an index</a>
              corresponding to the given key. If a record did not exist in this 
              <a>index</a> for the key <var>key</var> parameter, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a>.
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be removed</dd>
              </dl>
            </dd>
          </dl>
          <dl class="idl" title="interface IDBCursorRequest : IDBCursor">
            <dt>readonly attribute IDBRequest request</dt>
            <dd>The request associated with this object, which will be used to
            relay the results of processing back to the caller. When the 
            cursor is moved, the result attribute is set to <code>false</code>
            if there are no more records in the cursor.</dd>
            <dt>readonly attribute any key</dt>
            <dd>The key for the record at the <a>cursor</a>'s <a>position</a>.</dd>
            <dt>readonly attribute any value</dt>
            <dd>The value for the record at the <a>cursor</a>'s <a>position</a>.</dd>
            <dt>readonly attribute unsigned long long count</dt>
            <dd>             
              On getting, provide the approximate number of objects in the cursor.
            </dd>
            <dt>void update(in any value)</dt>
            <dd>
              This method returns immediately and sets the value for the record at the
              <a>cursor</a>'s <a>position</a>. If the underlying <a>object store</a> uses
              <a>in-line keys</a> and the property at the 
              <a title="object store key path">key path</a> does not match the key in this
              <a>cursor</a>'s <a>position</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this object's 
              request is set to code <a class="idlType" href="#widl-IDBDatabaseException-DATA_ERR"><code>DATA_ERR</code></a>. If the underlying 
              <a>index</a> or <a>object store</a> does not support updating the item 
              because it is open in the <a class="idlType" href="#widl-IDBObjectStore-READ_ONLY"><code>READ_ONLY</code></a> or 
              <a class="idlType" href="#widl-IDBObjectStore-SNAPSHOT_READ"><code>SNAPSHOT_READ</code></a> <a>mode</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this
              object's request is set to code <a class="idlType" href="#widl-IDBDatabaseException-NOT_ALLOWED_ERR"><code>NOT_ALLOWED_ERR</code></a>.
              If the data being stored could not be serialized by the 
              <a>internal structured cloning algorithm</a>,  then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this 
              object's request is set to code <a class="idlType" href="#widl-IDBDatabaseException-SERIAL_ERR"><code>SERIAL_ERR</code></a>.
            </dd>
            <dt>void    continue()</dt>
            <dd>
              This method returns immediately and advances the <a>cursor</a> to the next
              position along its <a>direction</a> to the item whose key matches the
              optional parameter. If no such parameter is provided, advance to the
              immediate next position. If the <a>cursor</a> has reached the end of its
              <a>range</a>, then  the <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code
              <a class="idlType" href="#widl-IDBDatabaseException-NOT_ALLOWED_ERR"><code>NOT_ALLOWED_ERR</code></a>.
              <dl class="parameters">
                <dt>optional any key</dt>
                <dd>The next key to position this <a>cursor</a> at</dd>
              </dl>
            </dd>
            
            <dt>void    remove()</dt>
            <dd>          
              <p>
                This method returns immediately and deletes the object at the 
                <a>cursor</a>'s <a>position</a>. The cursor's
                position is not changed. Any attempts to retrieve the cursor's
                current value will return <code>null</code>. If the underlying 
                <a>index</a> or <a>object store</a> does not support updating the item 
                because it is open in the 
                <a class="idlType" href="#widl-IDBObjectStore-READ_ONLY"><code>READ_ONLY</code></a> or 
                <a class="idlType" href="#widl-IDBObjectStore-SNAPSHOT_READ"><code>SNAPSHOT_READ</code></a> 
                <a>mode</a>, then the 
                <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this object's request is set to code 
                <a class="idlType" href="#widl-IDBDatabaseException-NOT_ALLOWED_ERR"><code>NOT_ALLOWED_ERR</code></a>.
              </p>
            </dd>
          </dl>
          <dl class="idl" title="interface IDBTransactionRequest : IDBTransaction">
            <dt>readonly attribute IDBRequest request</dt>
            <dd>The request associated with this object, which will be used to
            relay the results of processing back to the caller</dd>
            <dt>void abort()</dt>
            <dd>
              This method returns immediately and undoes all the changes performed to 
              the <a>objects</a> of this <a>database</a> since the creation of this 
              <a>transaction</a>. If this <a>transaction</a> has already been committed
              or aborted,  then the <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code
              <a class="idlType" href="#widl-IDBDatabaseException-NON_TRANSIENT_ERR"><code>NON_TRANSIENT_ERR</code></a>.
            </dd>
            <dt>void commit()</dt>
            <dd>
              This method returns immediately and durably stores all the changes made
              to the <a>objects</a> of this <a>database</a> since the creation of this
              <a>transaction</a>. If this <a>transaction</a> has already been committed
              or aborted,  then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a> for this object's request is set to code
              <a class="idlType" href="#widl-IDBDatabaseException-NON_TRANSIENT_ERR"><code>NON_TRANSIENT_ERR</code></a>. If this <a>transaction</a>'s 
              <a>scope</a> is <a>dynamic</a>, and the user agent cannot commit all the
              changes due to conflicts with another <a>transaction</a>, then the 
              <a class="idlType" href="#widl-IDBRequest-error"><code>error</code></a>
              for this object's request is set to code
              <a class="idlType" href="#widl-IDBDatabaseException-RECOVERABLE_ERR"><code>RECOVERABLE_ERR</code></a>.
            </dd>
          </dl>
        </section>
                  
        <section class="section" id="event-handler">
          <h4>Events</h4>
          <p>
            The following are the <span>event handlers</span> (and their corresponding 
            <span>event handler event types</span>) that MUST be supported, as IDL
            attributes, by objects implementing the <a><code>IDBRequest</code></a> interface:
          </p>
          
          <table>
            <thead><tr>
              <th><span>Event handler</span> </th>
              <th><span>Event handler event type</span></th>
            </tr></thead>
            <tbody>
              <tr>
                <td><dfn id="handler-request-onsuccess"><code>onsuccess</code></dfn> </td>
                <td> <code><a class="idlType" href="#event-success">success</a></code></td>
              </tr>
              <tr>
                <td><dfn id="handler-request-onerror"><code>onerror</code></dfn> </td>
                <td> <code><a class="idlType" href="#event-error">error</a></code></td>
              </tr>
            </tbody>
          </table>        
        </section>
        <section id="database-exception" class="section">
          <h3>The <code>IDBDatabaseError</code> Interface</h3>
          <p>
            Errors in the asynchronous database API are reported using 
            events that have a <a><code>IDBDatabaseError</code></a> 
            object as one of their arguments.
          </p>
          <dl class="idl" title="interface IDBDatabaseError">
            <dt>attribute unsigned short code</dt>
            <dd>
              Return the most appropriate error code.
            </dd>
            <dt>attribute DOMString message</dt>
            <dd>
              Return an error message describing the exception raised. 
              The message should be localized to the user's language.
            </dd>
          </dl>  
        </section>
      </section>            
    </section> <!-- API -->      

      <!-- end-content -->
    </section>
  </body>
</html>
