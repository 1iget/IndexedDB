<!DOCTYPE html>
<html lang='en-US'>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
    <title>Indexed Database API</title>
    <meta name='revision' content='$Id: Overview.html,v 1.41 2010/03/24 17:58:17 nmehta3 Exp $'/>
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/respec.js' class='remove'></script>
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/simple-node.js' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          specStatus:           "ED",

          shortName:            "IndexedDB",

          //publishDate:          "2010-01-05",

          previousPublishDate:  "2010-01-05",
          previousMaturity:     "WD",

          edDraftURI:           "http://dvcs.w3.org/hg/IndexedDB/raw-file/tip/Overview.html",

          // if this is a LCWD, uncomment and set the end of its review period
                       // lcEnd: "2009-08-05",

          extraCSS: [
                "http://dev.w3.org/2009/dap/ReSpec.js/css/respec.css",
                "SimpleDB.css"
          ],

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Nikunj Mehta", url: "mailto:nikunj@o-micron.com",
                company: "Invited Expert" },
              { name: "Jonas Sicking", url: "mailto:jonas@sicking.cc",
                company: "Mozilla" },
              { name: "Eliot Graff", url: "mailto:eliotgra@microsoft.com",
                company: "Microsoft" },
              { name: "Andrei Popescu", url: "mailto:andreip@google.com",
                company: "Google" }
              { name: "Jeremy Orlow", url: "mailto:jorlow@google.com",
                company: "Google" }
          ],

          maxTocLevel: 3,

          wg:           "Web Applications Working Group",

          wgURI:        "http://www.w3.org/2008/webapps/",

          wgPublicList: "public-webapps",

          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/42538/status",
      };
    </script>
    <script class="remove">
      function examples() {
        var examples = document.querySelectorAll('div.example');
        sn = new berjon.simpleNode({
                        "":     "http://www.w3.org/1999/xhtml",
                        "x":    "http://www.w3.org/1999/xhtml"
                    });
        for (var i = 0; i < examples.length; i++) {
          var example = examples.item(i);
          var header = sn.element('div', {'class': 'exampleHeader'}, null, 'Example');
          example.insertBefore(header, example.firstChild);
        }
      }

      function codeblocks() {
        document.normalize();
        sn = new berjon.simpleNode({
                        "":     "http://www.w3.org/1999/xhtml",
                        "x":    "http://www.w3.org/1999/xhtml"
                    });

        var blocks = document.querySelectorAll('codeblock');
        for (var i = 0; i < blocks.length; i++) {
          var codeblock = blocks.item(i);
          var div = sn.element('div', {'class': 'block'})
          sn.element('span', {'class': 'blockTitle'},
            sn.element('div', {'class': 'blockTitleDiv'}, div), 'ECMAScript');
          var code = sn.element('code', {'class': 'es-code'},
                       sn.element('pre', {'class': 'code'},
                         sn.element('div', {'class': 'blockContent'}, div)));
          sn.copyChildren(codeblock, code);
          codeblock.parentNode.replaceChild(div, codeblock);
        }
      }
      window.onload = function() {
        examples();
        codeblocks();
        (new berjon.respec()).loadAndRun();
      }
    </script>
    <!--[if IE]>
    <style type='text/css'>
      .ignore {
        -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
        filter: alpha(opacity=50);
      }
    </style>
    <![endif]-->
    <style type="text/css">
      table {
        border-collapse: collapse;
        border-style: hidden hidden none;
      }
      table thead {
        border-bottom: medium solid;
      }
      table td, table th {
        border-bottom: thin solid;
        border-left: medium solid;
        border-right: medium solid;
        padding: 0.2em;
        vertical-align: top;
      }
      h5 {
        display: none
      }
    </style>
  </head>

  <body>
    <section id="abstract">
      <p>
        This document defines APIs for a database of records holding simple values
        and hierarchical objects. Each record consists of a key and some value.
        Moreover, the database maintains indexes over records it stores. An
        application developer directly uses an API to locate records either by
        their key or by using an index. A query language can be layered on this
        API. An indexed database can be implemented using a persistent B-tree data
        structure.
      </p>
    </section>

    <section id="database-api" class="section">
      <h2>Indexed Database API</h2>

      <!-- begin-content -->
      <section class="section" id="async-api"> 
        <h3>Asynchronous APIs</h3>
        <p>
          The asynchronous API methods return without blocking the calling thread.
          All asynchronous operations immediately return an <a><code>IDBRequest</code></a> instance.
          This object does not initially contain any information about the result of the operation.
          Once information becomes available, an event is fired on the request and the information becomes
          available thorugh the properties of the <a><code>IDBRequest</code></a> instance.
        </p>

        <section class="section" id="request-api">
          <h4>The <code>IDBRequest</code> Interface</h4>
          <p>
            The <a><code>IDBRequest</code></a> interface provides means to access results of  
            asynchronous requests to <a title="database">databases</a> and <a>database</a> 
            <a>objects</a> using <a>event handler attributes</a> [[!DOM-LEVEL-3-EVENTS]]. 
          </p>
          <div class="example">       
            <p>
              In the following example, we open a <a>database</a> asynchronously. Various 
              event handlers are registered for responding to various situations.
            </p>
            <codeblock>
 var request = indexedDB.<a>open</a>('AddressBook', 'Address Book');
 request.<a>onsuccess</a> = function(evt) {...};
 request.<a>onerror</a> = function(evt) {...};
            </codeblock>
          </div>
          <dl class="idl" title="interface IDBRequest : EventTarget">
            <dt>readonly attribute any result</dt>
            <dd>
              When the <a title="request done">done</a> flag is true, getting this
              property MUST return the <a title="request result">result</a> of
              the request. This is <code>undefined</code> when the request resulted
              in an error. When the <a title="request done">done</a> flag is
              false, getting this property MUST throw a <code>NOT_ALLOWED_ERR</code>
              exception.
              <dl class="getraises" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>Thrown when this attribute was read when the <a title="request done">done</a> flag was set to false.</dd>
              </dl>
            </dd>
            <dt>readonly attribute unsigned short errorCode</dt>
            <dd>
              When the <a title="request done">done</a> flag is true, getting this
              property MUST return the <a title="request errorCode">errorCode</a> of
              the request. This is <a>NO_ERR</a> when no error occurred. When the
              <a title="request done">done</a> flag is false, getting this property
              MUST throw a <code>NOT_ALLOWED_ERR</code> exception.
              <!-- XXX The js-library doesn't do the exception correctly here -->
              <dl class="getraises" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>Thrown when this attribute was read when the <a title="request done">done</a> flag was set to false.</dd>
              </dl>
            </dd>
            <dt>readonly attribute Object source</dt>
            <dd>
              Getting this property MUST return the <a title="request source">source</a>
              for the request.
            </dd>
            <dt>readonly attribute IDBTransaction transaction</dt>
            <dd>
              Getting this property MUST return the <a title="request transaction">transaction</a>
              for the request. This property can be null for certain requests, such as for <a>request</a>
              returned from <a href="#widl-IDBFactory-open">IDBFactory.open</a> and
              <a href="#widl-IDBDatabase-setVersion">IDBDatabase.setVersion</a>.
            </dd>
            <dt>const     unsigned short LOADING = 1</dt>
            <dd>This state indicates that a request has been started but its results is not
            yet available.</dd>
            <dt>const     unsigned short DONE = 2</dt>
            <dd>This state indicates that a result to a previous request is available in
            the <a class="idlType" href="#widl-IDBRequest-result"><code>result</code></a> attribute.</dd>
            <dt>readonly attribute unsigned short readyState</dt>
            <dd>When the <a title="request done">done</a> flag is false, returns
            <a class="idlType" href="#widl-IDBRequest-LOADING"><code>LOADING</code></a>,
            otherwise returns
            <a class="idlType" href="#widl-IDBRequest-DONE"><code>DONE</code></a>.</dd>
            <dt>attribute Function onsuccess</dt>
            <dd>The event handler for the <a title="event-success">success event</a></dd>
            <dt>attribute Function onerror</dt>
            <dd>The event handler for the <a title="event-error">error event</a></dd>
          </dl>
          <p>
            When a request is made, the 
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a> changes to 
            <a class="idlType" href="#widl-IDBRequest-LOADING"><code>LOADING</code></a>. 
            If a request completes successfully, the
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            changes to <a class="idlType" href="#widl-IDBRequest-DONE"><code>DONE</code></a>, 
            the result of the request is included as the 
            <a class="idlType" href="#widl-IDBSuccessEvent-result"><code>result</code></a> of
            a new <a class="idlType" href="#widl-IDBSuccessEvent"><code>IDBSuccessEvent</code></a> 
            event, and <a>queue a task</a> to fire that event with the name <code>success</code>, 
            with no namespace, which does not bubble, is not cancelable at each 
            <a class="externalDFN"><code>Window</code></a> object.
          </p>
          <p>
            If an error occurs while performing the operation, the 
            <a class="idlType" href="#widl-IDBRequest-readyState"><code>readyState</code></a>
            changes to <a class="idlType" href="#widl-IDBRequest-DONE"><code>DONE</code></a>, 
            the error code and message are included in a new <a><code>IDBDatabaseError</code></a>
            event, and <a>queue a task</a> to fire that event with the name 
            <code>error</code>, with no namespace, which does not bubble, is 
            not cancelable at each <a class="externalDFN"><code>Window</code></a> object.
          </p>
          <p>
            The <a href="#widl-IDBDatabase-setVersion">setVersion</a> function on <a>IDBDatabase</a>
            uses a separate interface for its <a>request</a>s in order to make use of the
            <code>blocked event</code> eaiser.
          </p>
          <dl class="idl" title="interface IDBVersionChangeRequest : IDBRequest"> 
            <dt>attribute Function onblocked</dt>
            <dd>The event handler for the <code>blocked event</code></dd>
          </dl>
          <p>
            The <span>task source</span> for these tasks is the 
            <dfn id="database-access-task-source">database access task source</dfn>.
          </p>    
        </section>

        <section class="section" id="events">
          <h4>Event interfaces</h4>
          <p>
            This specification fires events with the following custom interfaces:
          </p>

          <dl class="idl" title="interface IDBVersionChangeEvent : Event"> 
            <dt>readonly attribute DOMString version</dt>
            <dd>Returns the new version of the database during a VERSION_CHANGE transaction.
            See the <a>steps for running a <code>VERSION_CHANGE</code> transaction</a>.</dd>
          </dl>

        </section>
        
        <section class="section" id="requests">
          <h4>Opening a database</h4>
         <p>
            <a title="Window" class="externalDFN"><code>Window</code></a> and 
            <a title="Worker" class="externalDFN"><code>Worker</code></a> objects 
            MUST implement the <a><code>IDBEnvironment</code></a> interface.
          </p>
          <p class="idl" title="Window implements IDBEnvironment">
          <p class="idl" title="Worker implements IDBEnvironment">
          </p>
          
          <dl class="idl" title="[NoInterfaceObject] interface IDBEnvironment">
            <dt>readonly attribute IDBFactory indexedDB</dt>
            <dd>This attribute provides applications a mechanism for accessing
              capabilities of indexed databases.</dd>
          </dl>
          <p>
            Every method for making asynchronous requests returns an 
            <a><code>IDBRequest</code></a> object that communicates back to the requesting
            application through events.
            This design means that any number of requests can be active on any <a>database</a>
            or <a title="objects">object</a> handle at a time. 
          </p>

          <dl class="idl" title="interface IDBFactory">
            <dt>IDBRequest open()</dt>
            <dd>
              <p>
                When invoked, this method creates an <a>IDBRequest</a> and returns it.
                It then asynchronously runs the <a>steps for opening a database</a>.
                Let <var>origin</var> be the origin of the <a>IDBEnvironment</a> used to access
                this <a>IDBFactory</a> and <var>name</var> be the <var>name</var> parameter passed
                to this function.
              </p>
              <p>
                If an error is returned from the steps above, then the implementation MUST
                fire an <a title="event-error">error event</a> on the <a>IDBRequest</a> returned from
                this method, with its 
                <a class="idlType" href="#widl-IDBErrorEvent-code"><code>code</code></a>
                and <a class="idlType" href="#widl-IDBErrorEvent-message"><code>message</code></a> set to
                appropriate values for the error.
              </p>
              <p>
                If the steps above are successful, the implementation MUST fire a <a title="event-success">success event</a>
                on the <a>IDBRequest</a> returned above. The event MUST use the <a><code>IDBSuccessEvent</code></a> interface with its 
                <a class="idlType" href="#widl-IDBSuccessEvent-result"><code>result</code></a> 
                set to the <a>connection</a> returned from the steps.
              </p>
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="database name">name</a> for the <a>database</a></dd>
              </dl>
            </dd>
            <dt>IDBRequest deleteDatabase()</dt>
            <dd>
              <p>
                When invoked, this method creates an <a>IDBRequest</a> and returns it.
                It then asynchronously runs the <a>steps for deleting a database</a>.
                Let <var>origin</var> be the origin of the <a>IDBEnvironment</a> used to access
                this <a>IDBFactory</a> and <var>name</var> be the <var>name</var> parameter passed
                to this function.
              </p>
              <p>
                If an error is returned from the steps above, then the implementation MUST
                fire an <a title="event-error">error event</a> on the <a>IDBRequest</a> returned from
                this method, with its 
                <a class="idlType" href="#widl-IDBErrorEvent-code"><code>code</code></a>
                and <a class="idlType" href="#widl-IDBErrorEvent-message"><code>message</code></a> set to
                appropriate values for the error.
              </p>
              <p>
                If the steps above are successful, the implementation MUST fire a <a title="event-success">success event</a>
                on the <a>IDBRequest</a> returned above. The event MUST use the <a><code>IDBSuccessEvent</code></a> interface with its 
                <a class="idlType" href="#widl-IDBSuccessEvent-result"><code>result</code></a> 
                set to <code>null</code>.
              </p>
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="database name">name</a> for the <a>database</a></dd>
              </dl>
            </dd>
          </dl>
        </section>
        <section id="database-interface" class="section">
          <h4>Database</h4>
          <!-- TODO Add example. Should examples be in a separate section?-->
          <p>
            A <a>database</a> object can be used to manipulate the 
            <a>objects</a> of that <a>database</a>. That is also the only way to 
            obtaining a <a>transaction</a> for that <a>database</a>.
          </p>
          <dl class="idl" title="interface IDBDatabase : EventTarget">
            <dt>readonly attribute DOMString name</dt>
            <dd>
              On getting, this attribute MUST return the <a title="database name">name</a>
              of the <a title="connection">connected</a> <a>database</a>.
            </dd>
            <dt>readonly attribute DOMString version</dt>
            <dd>
              On getting, this attribute MUST return the <a>version</a> of this
              <a>database</a>. This attribute has the empty string value when the
              <a title="connection">connected</a> <a>database</a> is first created.
            </dd>
            <dt>readonly attribute DOMStringList objectStoreNames</dt>
            <dd>
              On getting, this attribute MUST return a list of names of the 
              <a title="object store">object stores</a> currently in the 
              <a title="connection">connected</a> <a>database</a>.
            </dd>
            <dt>IDBObjectStore createObjectStore()</dt>
            <dd>
              <p>
                This method creates and returns a new <a>object store</a> with the given name in the 
                <a title="connection">connected</a> <a>database</a>. Note that this method must only
                be called from a <a><code>VERSION_CHANGE</code></a> <a>transaction</a> callback.
              </p>
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="object store name">name</a> of a new <a>object store</a></dd>
                <dt>[TreatNullAs=EmptyString] optional DOMString keyPath</dt>
                <dd>The <a title="object store key path">key path</a> of a new 
                <a>object store</a>. If <a>empty</a> path is specified, then the 
                <a>object store</a> created will not have a <a>key path</a> and will
                use <a>out-of-line keys</a>.</dd>
                <dt>optional boolean autoIncrement</dt>
                <dd>Whether the <a>object store</a> created should have a 
                <a>key generator</a>. This defaults to <code>false</code>.</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>This method was not called from a <a><code>VERSION_CHANGE</code></a> <a>transaction</a> callback.</dd>
                <dt>CONSTRAINT_ERR</dt>
                <dd>An <a>object store</a> with the same name, compared in a 
                case-sensitive manner, already exists in the 
                <a title="connection">connected</a> <a>database</a>. </dd>
              </dl>
            </dd>
            <dt>IDBRequest deleteObjectStore()</dt>
            <dd>
              <p>
                This method destroys the <a>object store</a> with the given name in the 
                <a title="connection">connected</a> <a>database</a> as well as 
                all <a title="index">indexes</a> that are 
                <a title="referenced">referencing</a> that <a>object store</a>.
                Note that this method must only be called from a <a><code>VERSION_CHANGE</code></a>
                <a>transaction</a> callback.
              </p>
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="object store name">name</a> of an existing
                <a>object store</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>This method was not called from a <a><code>VERSION_CHANGE</code></a> <a>transaction</a> callback.</dd>
                <dt>NOT_FOUND_ERR</dt>
                <dd>There is no <a>object store</a> with the given name, compared in a 
                case-sensitive manner, in the  <a title="connection">connected</a> <a>database</a>.</dd>
              </dl>
            </dd>
            <dt>IDBVersionChangeRequest setVersion()</dt>
            <dd>
              This method updates the <a>version</a> of the <a>database</a> by following the
              <a>steps for running a <code>VERSION_CHANGE</code> transaction</a> using
              the <var>version</var> argument as <var>version</var> and the <a>IDBDatabase</a>
              this function was called on as <var>connection</var>. Return the <a>IDBVersionChangeRequest</a>
              returned by those steps.
              <dl class="parameters">
                <dt>[TreatNullAs=EmptyString] DOMString      version</dt>
                <dd>The <a>version</a> to store in the <a>database</a></dd>
              </dl>
            </dd>
            <dt>IDBTransaction transaction()</dt>
            <dd>
              <p>
                This method, when called MUST execute the
                <a title="create a transaction">steps for creating a transaction</a> in a asychronous
                fashion. If the <var>storeNames</var> argument is provided and non-empty then then use that
                list as the <var>names</var> argument. Otherwise use the full set of <a>object store</a>
                names for the <a>IDBDatabase</a> as <var>names</var> argument. The <var>mode</var> argument is
                forwarded to the algorithm as-is. The <var>timeout</var> argument is set to infinite.
                The <var>connection</var> argument is set to the <a>IDBDatabase</a> that the
                <code>transaction()</code> method was called on.
              </p>
              <p>
                The method returns a <a>IDBTransaction</a> object representing the <a>transaction</a>
                returned by the steps above</a>.
              </p>
              <dl class="parameters">
                <dt>optional DOMStringList storeNames</dt>
                <dd>The names of <a title="object store">object stores</a> and 
                <a title="index">indexes</a> in the <a>scope</a> of the new
                <a>transaction</a></dd>
                <dt>optional unsigned short mode</dt>
                <dd> The <a>mode</a> for isolating access to data inside the given
                <a title="object store">object stores</a>. If this parameter is not provided, the default
                access <a>mode</a> is <code>READ_ONLY</code>.</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>The close() method has been called on this <a>IDBDatabase</a> instance.</dd>
                <dt>NOT_FOUND_ERR</dt>
                <dd>One of the names provided in the <var>storeNames</var> argument doesn't exist in this <a>database</a>.</dd>
              </dl>
            </dd>
            <dt>void close()</dt>
            <dd>
              This method returns immediately and performs the <a>steps for closing a database connection</a>.
            </dd>
            <dt>attribute Function onabort</dt>
            <dd>The event handler for the <a>abort event</a>.</dd>
            <dt>attribute Function onerror</dt>
            <dd>The event handler for the <a>error event</a>.</dd>
            <dt>attribute Function onversionchange</dt>
            <dd>The event handler for the <a>versionchange event</a>.</dd>
          </dl>
        </section>
        <section class="section" id="object-store">
          <h4>Object Store</h4>
          <a title="object store">Object store</a> objects implement the following
          interface:
          <dl class="idl" title="interface IDBObjectStore">
            <dt>readonly attribute DOMString      name</dt>
            <dd>          
              On getting, provide the <a title="object store name">name</a> of this
              object store.        
            </dd>
            <dt>readonly attribute DOMString      keyPath</dt>
            <dd>
              On getting, provide the <a title="object store key path">key path</a>
              of this <a>object store</a>. If this attribute is <code>null</code>,
              the application MUST provide a key value for each modification operation.
            </dd>
            <dt>readonly attribute DOMStringList  indexNames</dt>
            <dd>
            On getting, provide a list of the names of <a title="index">indexes</a> on 
            objects in this <a>object store</a>.
            </dd>
            <dt>IDBRequest put()</dt>
            <dd>
              <p>
                This method throws a READ_ONLY_ERR if the transaction which this IDBObjectStore belongs to is
                has its <a>mode</a> set to READ_ONLY. If any of the following conditions are true, this method
                throws a DATA_ERR exception:
              </p>
              <ul>
                <li>
                  The object store uses <a>in-line keys</a> or has a <a>key generator</a> and
                  the <var>key</var> parameter was provided.
                </li>
                <li>
                  The object store uses <a>out-of-line keys</a> and has no <a>key generator</a>
                  and the <var>key</var> parameter was not provided.
                </li>
                <li>
                  The object store uses <a>in-line keys</a> but no <a>key generator</a>
                  and the result of <a title="evaluate key path">evaluating</a> the 
                  <a title="object store key path">object store's key path</a> does not yield a
                  <a>valid key</a>.
                </li>
                <li>
                  The <var>key</var> parameter was provided but does not contain a <a>valid key</a>.
                </li>
                <li>
                  If there are any <a>index</a>es <a title="referenced">referencing</a> this object
                  store and <a title="evaluate key path">evaluating</a> their key path on the
                  <var>value</var> parameter yields a value and that value is not a <a>valid key</a>.
                </li>
              </ul>
              <p>
                Otherwise this method creates a <a>structured clone</a> of the <var>value</var> parameter.
                If this throws an exception that exception is rethrown. It then runs the <a>steps for
                asynchronously executing a request</a> and returns the <a>IDBRequest</a> created by these steps.
                The steps are run with this <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for
                storing a record into an object store</a> as <var>operation</var>, using this <a>IDBObjectStore</a>
                as <var>store</var>, the created clone as <var>value</var>, the <var>key</var> parameter as
                <var>key</var>, and with the <var>no-overwrite flag</var> flag set to false.
              </p>
              <dl class="parameters">
                <dt>any value</dt>
                <dd>The value to be stored in the <a>record</a></dd>
                <dt>optional any key</dt>
                <dd>The key used to identify the <a>record</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBObjectStore</a> belongs to is not <a>active</a>.</dd>
                <dt>READ_ONLY_ERR</dt>
                <dd>The <a>mode</a> of the associated <a>transaction</a> is <code>READ_ONLY</code>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The calculated key for the insertion was not a <a>valid key</a>. Also thrown if the
                calculated key for any of the indexes which belong to this object store had a calculated
                key which was not a <a>valid key</a></dd>
              </dl>
              <dl class="exception" title="DOMException">
                <dt>DATA_CLONE_ERR</dt>
                <dd>The data being stored could not be cloned by the internal
                structured cloning algorithm.</dd>
              </dl>
            </dd>
            <dt>IDBRequest add()</dt>
            <dd>
              <p>
                This method throws a READ_ONLY_ERR if the transaction which this IDBObjectStore belongs to is
                has its <a>mode</a> set to READ_ONLY. If any of the following conditions are true, this method
                throws a DATA_ERR exception:
              </p>
              <ul>
                <li>
                  The object store uses <a>in-line keys</a> or has a <a>key generator</a> and
                  the <var>key</var> parameter was provided.
                </li>
                <li>
                  The object store uses <a>out-of-line keys</a> and has no <a>key generator</a>
                  and the <var>key</var> parameter was not provided.
                </li>
                <li>
                  The object store uses <a>in-line keys</a> but no <a>key generator</a>
                  and the result of <a title="evaluate key path">evaluating</a> the 
                  <a title="object store key path">object store's key path</a> does not yield a
                  <a>valid key</a>.
                </li>
                <li>
                  The <var>key parameter was provided but does not contain a <a>valid key</a>.
                </li>
                <li>
                  If there are any <a>index</a>es <a title="referenced">referencing</a> this object
                  store and <a title="evaluate key path">evaluating</a> their key path on the
                  <var>value</var> parameter yields a value and that value is not a <a>valid key</a>.
                </li>
              </ul>
              <p>
                Otherwise this method creates a <a>structured clone</a> of the <var>value</var> parameter.
                If this throws an exception that exception is rethrown. It then runs the <a>steps for
                asynchronously executing a request</a> and returns the <a>IDBRequest</a> created by these steps.
                The steps are run with this <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for
                storing a record into an object store</a> as <var>operation</var>, using this <a>IDBObjectStore</a>
                as <var>store</var>, the created clone as <var>value</var>, the <var>key</var> parameter as
                <var>key</var>, and with the <var>no-overwrite flag</var> flag set to true.
              </p>
              <dl class="parameters">
                <dt>any value</dt>
                <dd>The value to be stored in the <a>record</a></dd>
                <dt>optional any key</dt>
                <dd>The key used to identify the <a>record</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBObjectStore</a> belongs to is not <a>active</a>.</dd>
                <dt>READ_ONLY_ERR</dt>
                <dd>The <a>mode</a> of the associated <a>transaction</a> is <code>READ_ONLY</code>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The calculated key for the insertion was not a <a>valid key</a>. Also thrown if the
                calculated key for any of the indexes which belong to this object store had a calculated
                key which was not a <a>valid key</a></dd>
              </dl>
              <dl class="exception" title="DOMException">
                <dt>DATA_CLONE_ERR</dt>
                <dd>The data being stored could not be cloned by the internal
                structured cloning algorithm.</dd>
              </dl>
            </dd>
            <dt>IDBRequest delete()</dt>
            <dd>
              <p>
                This method throws a READ_ONLY_ERR if the transaction which this IDBObjectStore belongs to is
                has its <a>mode</a> set to READ_ONLY. If the <var>key</var> parameter is not a <a>valid key</var>
                this method throws a DATA_ERR exception.
              </p>
              <p>
                Otherwise this method runs the <a>steps for
                asynchronously executing a request</a> and returns the <a>IDBRequest</a> created by these steps.
                The steps are run with this <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for deleting
                a record from an object store</a> as <var>operation</var>, using this <a>IDBObjectStore</a>
                as <var>store</var> and the <var>key</var> parameter as <var>key</var>.
              </p>
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the <a>record</a> to be deleted</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBObjectStore</a> belongs to is not <a>active</a>.</dd>
                <dt>READ_ONLY_ERR</dt>
                <dd>The <a>mode</a> of the <a>transaction</a> this <a>IDBObjectStore</a> belongs to is READ_ONLY.</dd>
              </dl>
            </dd>
            <dt>IDBRequest get()</dt>
            <dd>
              <p>
                If the <var>key</var> parameter is not a <a>valid key</a> or a <a>key range</a>, this method
                throws a DATA_ERR exception. Otherwise, this method runs the <a>steps for asynchronously executing
                a request</a> and returns the <a>IDBRequest</a> created by these steps. The steps are run with this
                <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for retrieving a value from an
                object store</a> as <var>operation</var>, using this <a>IDBObjectStore</a> as <var>store</var> and the
                <var>key</var> parameter as <var>key</var>.
              </p>
              <p class="note">
                This function produces the same result if a record with the given key doesn't exist as when a record
                exists, but has <code>undefined</code> as value. If you need to tell the two situations apart, you can use
                <a href="#widl-IDBObjectStore-openCursor">openCursor</a> with the same key. This will return a cursor with
                <code>undefined</code> as value if a record exists, or no cursor if no such record exists.
              </p>
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the <a>record</a> to be retrieved. This can also be a <a>IDBKeyRange</a> in which case
                the function retreives the first existing value in that range.</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBObjectStore</a> belongs to is not <a>active</a>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>key</var> parameter was not passed a valid value.</dd>
              </dl>
            </dd>
            <dt>IDBRequest clear()</dt>
            <dd>
              <p>
                This method throws a READ_ONLY_ERR if the transaction which this IDBObjectStore belongs to is
                has its <a>mode</a> set to READ_ONLY.
              </p>
              <p>
                Otherwise this method runs the <a>steps for asynchronously executing a request</a> and returns the
                <a>IDBRequest</a> created by these steps. The steps are run with this <a>IDBObjectStore</a> as
                <var>source</var> and the <a>steps for clearing an object store</a> as <var>operation</var>, using
                this <a>IDBObjectStore</a> as <var>store</var>.
              </p>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBObjectStore</a> belongs to is not <a>active</a>.</dd>
                <dt>READ_ONLY_ERR</dt>
                <dd>The <a>mode</a> of the <a>transaction</a> this <a>IDBObjectStore</a> belongs to is READ_ONLY.</dd>
              </dl>
            </dd>
            <dt>IDBRequest openCursor()</dt>
            <dd>
              <p>
                If the <var>range</var> parameter is specified but is not a <a>valid key</a> or a <a>key range</a>,
                this method throws a DATA_ERR exception. Otherwise, this method creates a <a>cursor</a> with an undefined
                <a>position</a>, a <a>direction</a> set to the value of the <var>direction</var> parameter, false as
                <a>iterable</a> flag value, and undefined <a title="cursor key">key</a> and
                <a title="cursor value">value</a>. The <a title="cursor source">source</a> of the cursor is the
                <a>IDBObjectStore</a> this function was called on.
              </p>
              <p>
                If the <var>range</var> parameter is a <a>key range</a> then the cursor's <a>range</a> is set to that
                range. Otherwise, if the <var>range</var> parameter is a <a>key range</a> then the cursor's <a>range</a>
                is set to <a>key range</a> containing only that key value. If the <var>range</var> parameter is not specified,
                the cursor's key range is left as undefined.
              </p>
              <p>
                This method runs the <a>steps for asynchronously executing a request</a> and returns the <a>IDBRequest</a>
                created by these steps. The steps are run with this <a>IDBObjectStore</a> as <var>source</var> and the
                <a>steps for iterating a cursor</a> as <var>operation</var>,
                using the created cursor as <var>cursor</var> and with undefined as <var>key</var>.
              </p>
              <dl class="parameters">
                <dt>optional any            range</dt>
                <dd>The <a>key range</a> to use as the <a>cursor</a>'s <a>range</a></dd>
                <dt>optional unsigned short direction</dt>
                <dd>The <a>cursor</a>'s required <a>direction</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBObjectStore</a> belongs to is not <a>active</a>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>range</var> parameter was not passed a valid value.</dd>
              </dl>
            </dd>
            <dt>IDBIndex createIndex()</dt>
            <dd>
              <p>
                This creates and returns a new <a>index</a> with the given name and parameters in the 
                <a title="connection">connected</a> <a>database</a>.  Note that this method must only
                be called from a <a><code>VERSION_CHANGE</code></a> <a>transaction</a> callback.
              </p>
              <dl class="parameters">
                <dt>DOMString      name</dt>
                <dd>The <a title="index name">name</a> of a new <a>index</a></dd>
                <!-- this is removed because it is implicit on the store
                <dt>DOMString      storeName</dt>
                <dd>The <a title="object store name">name</a> of an existing
                <a>object store</a> <a>referenced</a> by the new <a>index</a></dd>-->
                <dt>DOMString      keyPath</dt>
                <dd>The <a title="index key path">key path</a> used by the new
                <a>index</a></dd>
                <dt>optional boolean unique</dt>
                <dd>The <a>unique</a> flag for the new <a>index</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>This method was not called from a <a><code>VERSION_CHANGE</code></a> 
                <a>transaction</a> callback.</dd>
                <dt>CONSTRAINT_ERR</dt>
                <dd>An <a>index</a> with the same name, compared in a 
                case-sensitive manner, already exists in the 
                <a title="connection">connected</a> <a>database</a>. </dd>
              </dl>
            </dd>
            <dt>IDBIndex index()</dt>
            <dd>
              Returns a <a>IDBIndex</a> representing a <a>index</a> that is part of the
              to this <a>object store</a>. Every call to this function on the same
              <a>IDBObjectStore</a> instance and with the same <var>name</var> returns the same <a>IDBIndex</a> instance.
              However the retured <a>IDBIndex</a> instance is specific to this <a>IDBObjectStore</a> instance. If this
              function is called on a different <a>IDBObjectStore</a> instance, a different <a>IDBIndex</a> instance is
              returned. A result of this is that different <a>IDBTransaction</a>s use different <a>IDBIndex</a> instances
              to represent the same <a>index</a>.
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The <a title="index name">name</a> of an existing <a>index</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_FOUND_ERR</dt>
                <dd>There is no <a>index</a> with the given name, compared in a 
                case-sensitive manner, in the <a title="connection">connected</a> <a>database</a>.</dd>
              </dl>
            </dd>
            <dt>void deleteIndex()</dt>
            <dd>
              <p>
                This method destroys the <a>index</a> with the given name in the
                <a title="connection">connected</a> <a>database</a>. Note that this
                method must only be called from a <a><code>VERSION_CHANGE</code></a>
                <a>transaction</a> callback.
              </p>
              <dl class="parameters">
                <dt>DOMString indexName</dt>
                <dd>The <a title="index name">name</a> of an existing <a>index</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>This method was not called from a <a><code>VERSION_CHANGE</code></a>
                <a>transaction</a> callback.</dd>
                <dt>NOT_FOUND_ERR</dt>
                <dd>There is no <a>index</a> with the given name, compared in a 
                case-sensitive manner, in the  <a title="connection">connected</a> <a>database</a>.</dd>
              </dl>
            </dd>
          </dl>
        </section>
        <section class="section" id="index">
        <h4>Index</h4>
          <!-- TODO Add example. Should examples be in a separate section?-->
          <p>
            <a title="index">Index</a> objects implement the following interface:
          </p>
          <dl class="idl" title="interface IDBIndex">
            <dt>readonly attribute DOMString      name</dt>
            <dd>
              On getting, provide the <a title="index name">name</a> of this <a>index</a>.        
            </dd>
            <dt>readonly attribute DOMString      storeName</dt>
            <dd>
              On getting, provide the <a title="object store name">name</a> of this
              <a title="index">index's</a> <a>referenced</a> <a>object store</a>.
            </dd>
        
            <dt>readonly attribute DOMString      keyPath</dt>
            <dd>
              On getting, provide the <a title="index key path">key path</a> of this
              <a>index</a>. If this attribute is <code>null</code>,
              this <a>index</a> is not <a>auto-populated</a>.
            </dd>
            
            <dt>readonly attribute boolean unique</dt>
            <dd>
              On getting, provide the <a>unique</a> flag of this <a>index</a>.
            </dd>
            <dt>IDBRequest openCursor()</dt>
            <dd>
              <p>
                If the <var>range</var> parameter is specified but is not a <a>valid key</a> or a <a>key range</a>,
                this method throws a DATA_ERR exception. Otherwise, this method creates a <a>cursor</a> with an undefined
                <a>position</a>, a <a>direction</a> set to the value of the <var>direction</var> parameter, false as
                <a>iterable</a> flag value, and undefined <a title="cursor key">key</a> and
                <a title="cursor value">value</a>. The <a title="cursor source">source</a> of the cursor is the
                <a>IDBIndex</a> this function was called on.
              </p>
              <p>
                If the <var>range</var> parameter is a <a>key range</a> then the cursor's <a>range</a> is set to that
                range. Otherwise, if the <var>range</var> parameter is a <a>key range</a> then the cursor's <a>range</a>
                is set to <a>key range</a> containing only that key value. If the <var>range</var> parameter is not specified,
                the cursor's key range is left as undefined.
              </p>
              <p>
                This method runs the <a>steps for asynchronously executing
                a request</a> and returns the <a>IDBRequest</a> created by these steps. The steps are run with this
                <a>IDBIndex</a> as <var>source</var> and the <a>steps for iterating a cursor</a> as <var>operation</var>,
                using the created cursor as <var>cursor</var> and with undefined as <var>key</var>
              </p>
              <dl class="parameters">
                <dt>optional IDBKeyRange    range</dt>
                <dd>The <a>key range</a> to use as the <a>cursor</a>'s <a>range</a></dd>
                <dt>optional unsigned short direction</dt>
                <dd>The <a>cursor</a>'s required <a>direction</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The transaction this <a>IDBIndex</a> belongs to is not <a>active</a>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>range</var> parameter was not passed a valid value.</dd>
              </dl>
            </dd>
            <dt>IDBRequest openKeyCursor()</dt>
            <dd>
              <p>
                If the <var>range</var> parameter is specified but is not a <a>valid key</a> or a <a>key range</a>,
                this method throws a DATA_ERR exception. Otherwise, this method creates a <a>cursor</a> with an undefined
                <a>position</a>, a <a>direction</a> set to the value of the <var>direction</var> parameter, false as
                <a>iterable</a> flag value, and undefined <a title="cursor key">key</a> and
                <a title="cursor value">value</a>. The <a title="cursor source">source</a> of the cursor is the
                <a>IDBIndex</a> this function was called on.
              </p>
              <p>
                If the <var>range</var> parameter is a <a>key range</a> then the cursor's <a>range</a> is set to that
                range. Otherwise, if the <var>range</var> parameter is a <a>key range</a> then the cursor's <a>range</a>
                is set to <a>key range</a> containing only that key value. If the <var>range</var> parameter is not specified,
                the cursor's key range is left as undefined.
              </p>
              <p>
                This method runs the <a>steps for asynchronously executing
                a request</a> and returns the <a>IDBRequest</a> created by these steps. The steps are run with this
                <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for iterating a cursor</a> as <var>operation</var>,
                using the created cursor as <var>cursor</var> and with undefined as <var>key</var>
              </p>
              <dl class="parameters">
                <dt>optional IDBKeyRange    range</dt>
                <dd>The <a>key range</a> to use as the <a>cursor</a>'s <a>range</a></dd>
                <dt>optional unsigned short direction</dt>
                <dd>The <a>cursor</a>'s required <a>direction</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The transaction this <a>IDBIndex</a> belongs to is not <a>active</a>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>range</var> parameter was not passed a valid value.</dd>
              </dl>
            </dd>
            <dt>IDBRequest get()</dt>
            <dd>
              <p>
                If the <var>key</var> parameter is not a <a>valid key</a> or a <a>key range</a>, this method
                throws a DATA_ERR exception. This method runs the <a>steps for asynchronously executing a request</a>
                and returns the <a>IDBRequest</a> created by these steps. The steps are run with this
                <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for retrieving a referenced value from an
                index</a> as <var>operation</var>, using this <a>IDBIndex</a> as <var>index</var> and the
                <var>key</var> parameter as <var>key</var>.
              </p>
              <p class="note">
                This function produces the same result if a record with the given key doesn't exist as when a record
                exists, but has <code>undefined</code> as value. If you need to tell the two situations apart, you can use
                <a href="#widl-IDBIndex-openCursor">openCursor</a> with the same key. This will return a cursor with
                <code>undefined</code> as value if a record exists, or no cursor if no such record exists.
              </p>
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be retrieved. This can also be a <a>IDBKeyRange</a> in which case
                the function retreives the first existing value in that range.</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The transaction this <a>IDBIndex</a> belongs to is not <a>active</a>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>key</var> parameter was not passed a valid value.</dd>
              </dl>
            </dd>
            <dt>IDBRequest getKey()</dt>
            <dd>
              <p>
                If the <var>key</var> parameter is not a <a>valid key</a> or a <a>key range</a>, this method
                throws a DATA_ERR exception. This method runs the <a>steps for asynchronously executing a request</a>
                and returns the <a>IDBRequest</a> created by these steps. The steps are run with this
                <a>IDBObjectStore</a> as <var>source</var> and the <a>steps for retrieving a value from an
                index</a> as <var>operation</var>, using this <a>IDBIndex</a> as <var>index</var> and the
                <var>key</var> parameter as <var>key</var>.
              </p>
              <p class="note">
                This function produces the same result if a record with the given key doesn't exist as when a record
                exists, but has <code>undefined</code> as value. If you need to tell the two situations apart, you can use
                <a href="#widl-IDBIndex-openKeyCursor">openKeyCursor</a> with the same key. This will return a cursor with
                <code>undefined</code> as value if a record exists, or no cursor if no such record exists.
              </p>
              <dl class="parameters">
                <dt>any key</dt>
                <dd>Key identifying the record to be retrieved. This can also be a <a>IDBKeyRange</a> in which case
                the function retreives the first existing value in that range.</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The transaction this <a>IDBIndex</a> belongs to is not <a>active</a>.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>key</var> parameter was not passed a valid value.</dd>
              </dl>
            </dd>
          </dl>
        </section>
        <section class="section" id="cursor">
          <h4>Cursor</h4>
          <!-- TODO Add example. Should examples be in a separate section?-->
          <p>
            <a title="cursor">Cursor</a> objects implement the following interface:
          </p>
          <dl class="idl" title="interface IDBCursor">
  <dt>const     unsigned short     NEXT = 0</dt>
            <dd>
              indicates that this <a>cursor</a> should yield all records, including  
              duplicates and its <a>direction</a> is monotonically increasing 
              order of keys.
            </dd>
            <dt>const     unsigned short     NEXT_NO_DUPLICATE = 1</dt>
            <dd>
              indicates that this <a>cursor</a> should yield all records, not including
              duplicates and its <a>direction</a> is monotonically increasing 
              order of keys. For every key with duplicate values, only the first
              record is yielded.
            </dd>
            <dt>const     unsigned short     PREV = 2</dt>
            <dd>
              indicates that <a>cursor</a> should yield all records, including  
              duplicates and its <a>direction</a> is monotonically decreasing 
              order of keys.
            </dd>
            <dt>const     unsigned short     PREV_NO_DUPLICATE = 3</dt>
            <dd>
              indicates that this <a>cursor</a> should yield all records, not including
              duplicates and its <a>direction</a> is monotonically decreasing 
              order of keys. For every key with duplicate values, only the first
              record is yielded.
            </dd>

            <dt>readonly attribute unsigned short     direction</dt>
            <dd>            
            On getting, provide the traversal <a>direction</a> of the <a>cursor</a>.
            </dd>
            <dt>readonly attribute any key</dt>
            <dd>Returns the cursor's current <a title="cursor key">key</a>. However if the cursor's <a>got value</a>
            flag is false it returns <code>undefined</code>. I.e. if it's currently being iterated or has
            iterated past the end of its range.</dd>
            <dt>readonly attribute any value</dt>
            <dd>Returns the cursor's current <a title="cursor value">value</a>. However if the cursor's <a>got value</a>
            flag is false it returns <code>undefined</code>. I.e. if it's currently being iterated or has
            iterated past the end of its range. Note that if this property returns an object, it returns the same
            object instance every time it is inspected, until the cursor is iterated. This means that if the object is modified,
            those modifications will be seen by anyone inspecting the value of the cursor. However modifying such an object
            does not modify the contents of the database.</dd>

            <dt>IDBRequest update(in any value)</dt>
            <dd>
              <p>
                This method throws a READ_ONLY_ERR if the transaction which this IDBCursor belongs to
                has its <a>mode</a> set to READ_ONLY. If this cursor's <a>got value</a> flag is false or if this
                cursor was created using
                <a class="idlType" href="#widl-IDBIndex-openKeyCursor"><code>openKeyCursor</code></a>. This method
                throws a NOT_ALLOWED_ERR. If the <a>effective object store</a> of this cursor uses <a>in-line</a>
                keys and <a title="evaluate key path">evaluating</a> the <a title="object store key path">key path</a>
                of the <var>value</var> parameter results in a different value than the cursor's <a>effective key</a>,
                this method throws DATA_ERR.
              </p>
              <p>
                Otherwise this method creates a <a>structured clone</a> of the <var>value</var> parameter.
                If this throws an exception that exception is rethrown. It then runs the <a>steps for
                asynchronously executing a request</a> and returns the <a>IDBRequest</a> created by these steps.
                The steps are run with this IDBCursor as <var>source</var> and the <a>steps for
                storing a record into an object store</a> as <var>operation</var>, using this cursor's
                <a>effective object store</a> as <var>store</var>, the created clone as <var>value</var>,
                this cursor's <a>effective key</a> as <var>key</var>, and with the <var>no-overwrite flag</var>
                flag set to false.
              </p>
              <p class="issue">
                Should this fire an error if the record had been deleted since we iterated to it? I.e. should
                this never be able to create a new record?
              </p>
              <p>
                Otherwise this method runs the <a>steps for asynchronously executing a request</a> and returns the
                <a>IDBRequest</a> created by these steps. The steps are run with this <a>IDBCursor</a> as <var>source</var>
                and the <a>steps for deleting a record from an object store</a> as <var>operation</var>, using this cursor's
                <a>effective object store</a> and <a>effective key</a> as <var>store</var> and <var>key</var> respectively.
              </p>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBCursor</a> belongs to is not <a>active</a>.</dd>
                <dt>READ_ONLY_ERR</dt>
                <dd>The <a>mode</a> of the <a>transaction</a> this <a>IDBCursor</a> belongs to
                is <code>READ_ONLY</code></dd>
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>Thrown if cursor was created using
                <a class="idlType" href="#widl-IDBIndex-openKeyCursor"><code>openKeyCursor</code></a> or if the cursor
                is currently being iterated or has iterated past the end.</dd>
                <dt>DATA_ERR</dt>
                <dd> The underlying <a>object store</a> uses <a>in-line keys</a> and the property in <var>value</var>
                at the object store's <a title="object store key path">key path</a> does not match the key in this <a>cursor</a>'s
                <a>position</a>.</dd>
              </dl>
              <dl class="exception" title="DOMException">
                <dt>DATA_CLONE_ERR</dt>
                <dd>The data being stored could not be cloned by the internal
                structured cloning algorithm.</dd>
              </dl>
            </dd>
            <dt>void    continue()</dt>
            <dd>
              <p>
                If the <var>key</var> parameter is specified but is not a <a>valid key</a>,
                this method throws a DATA_ERR exception. If this cursor's <a>got value</a> flag is false, this method
                throws a NOT_ALLOWED_ERR. Otherwise this method runs the <a>steps for asynchronously executing a request</a>.
                However, the steps are slightly modified such that instead of creating a new IDBRequest, it reuses the
                <a>request</a> originally created when this cursor was created. The <a title="request done">done</a> flag
                on the request is set to false before the request is returned.  The steps are run with the cursor's
                <a title="cursor source">source</a> as <var>source</var> and the <a>steps for iterating a cursor</a> as <var>operation</var>,
                using the created cursor as <var>cursor</var> and the <var>key</var> parameter as <var>key</var>.
              </p>
              <p>
                Before this method returns, unless an exception was thrown, it sets the <a>got value</a> flag fn the cursor to false.
              </p>
              <dl class="parameters">
                <dt>optional any key</dt>
                <dd>The next key to position this <a>cursor</a> at</dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBCursor</a> belongs to is not <a>active</a>.</dd>
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>The cursor is currently being iterated, or has iterated past its end.</dd>
                <dt>DATA_ERR</dt>
                <dd>The <var>key</var> parameter was specified but did not contain a <a>valid key</a>.</dd>
              </dl>
            </dd>
            
            <dt>IDBRequest    delete()</dt>
            <dd>          
              <p>
                This method throws a READ_ONLY_ERR if the transaction which this IDBCursor belongs to
                has its <a>mode</a> set to READ_ONLY. If this cursor's <a>got value</a> flag is false,
                or if this cursor was created using
                <a class="idlType" href="#widl-IDBIndex-openKeyCursor"><code>openKeyCursor</code></a> a
                NOT_ALLOWED_ERR is thrown.
              </p>
              <p>
                Otherwise this method runs the <a>steps for asynchronously executing a request</a> and returns the
                <a>IDBRequest</a> created by these steps. The steps are run with this <a>IDBCursor</a> as <var>source</var>
                and the <a>steps for deleting a record from an object store</a> as <var>operation</var>, using this cursor's
                <a>effective object store</a> and <a>effective key</a> as <var>store</var> and <var>key</var> respectively.
              </p>
              <p class="issue">
                This method used to set this cursor's <a title="cursor value">value</a> to <code>null</code>. Do we want to
                keep that?
              </p>
              <dl class="exception" title="IDBDatabaseException">
                <dt>TRANSACTION_INACTIVE_ERR</dt>
                <dd>The <a>transaction</a> this <a>IDBCursor</a> belongs to is not <a>active</a>.</dd>
                <dt>READ_ONLY_ERR</dt>
                <dd>The <a>mode</a> of the <a>transaction</a> this <a>IDBCursor</a> belongs to
                is <code>READ_ONLY</code>.</dd>
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>The cursor was created using
                <a class="idlType" href="#widl-IDBIndex-openKeyCursor"><code>openKeyCursor</code></a> or the cursor
                is currently being iterated or has iterated past the end.</dd>
              </dl>
            </dd>
          </dl>
        </section>
        <section class="section" id="transaction">
        <h4>Transaction</h4>
          <!-- TODO Add example. Should examples be in a separate section?-->
          <p>
            <a title="transaction">Transaction</a> objects implement the following interface:
          </p>
          <dl class="idl" title="interface IDBTransaction : EventTarget">
            <dt>const     unsigned short READ_ONLY    = 0</dt>
            <dd>Modification operations are not allowed in the <a>transaction</a>
            in this mode.</dd>
            <dt>const     unsigned short READ_WRITE    = 1</dt>
            <dd>Modification operations are allowed in the <a>transactions</a>
            in this mode.</dd>
            <dt>const     unsigned short VERSION_CHANGE = 2</dt>
            <dd>This mode is used solely for updating the version number of
            transactions started using the <code>setVersion()</code> method of <a><code>IDBDatabase</code></a>.</dd>
            <dt>readonly attribute unsigned short mode</dt>
            <dd>On getting, provide the <a>mode</a> for isolating access to data inside
            the <a title="object store">object stores</a> that are in the
            <a>scope</a> of the <a>transaction</a>.</dd>
            <dt>readonly attribute IDBDatabase db</dt>
            <dd>The <a>database</a> <a>connection</a> of which this <a>transaction</a>
              is a part
            </dd>
            <dt>IDBObjectStore objectStore()</dt>
            <dd>
              Returns a <a>IDBObjectStore</a> representing a <a>object store</a> that is part of the
              to the <a>scope</a> of this <a>transaction</a>. Every call to this function on the same
              <a>IDBTransaction</a> instance and with the same <var>name</var> returns the same <a>IDBObjectStore</a> instance.
              However the returned <a>IDBObjectStore</a> instance is specific to this <a>IDBTransaction</a>. If this
              function is called on a different <a>IDBTransaction</a>, a different <a>IDBObjectStore</a> instance is returned.
              <dl class="parameters">
                <dt>DOMString name</dt>
                <dd>The requested <a>object store</a></dd>
              </dl>
              <dl class="exception" title="IDBDatabaseException">
                <dt><a class="idlType" href="#widl-IDBDatabaseException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></a></dt>
                <dd>
                If the requested <a>object store</a> is not in this 
                <a>transaction</a>'s <a>scope</a>.
                </dd>
              </dl>
            </dd>
            <dt>void abort()</dt>
            <dd>
              If this <a>transaction</a> is <a title="transaction finish">finished</a>, throw a NOT_ALLOWED_ERR
              exception. Otherwise this method <a title="transaction abort">aborts</a> the transaction by running the
              <a>steps for aborting a transaction</a> with <var>code</var> set to ABORT_ERR.
              <dl class="exception" title="IDBDatabaseException">
                <dt>NOT_ALLOWED_ERR</dt>
                <dd>If this <a>transaction</a> has already been committed or aborted.</dd>
              </dl>
            </dd>
            <dt>attribute Function onabort</dt>
            <dd>The event handler for the <a>abort event</a>.</dd>
            <dt>attribute Function oncomplete</dt>
            <dd>The event handler for the <a>complete event</a>.</dd>
            <dt>attribute Function onerror</dt>
            <dd>The event handler for the <a>error event</a>.</dd>
          </dl>

        </section>
      </section>
      <!-- end-content -->
    </section>
  </body>
</html>
